{% extends 'seer/base.html.twig' %}

{% block main_content %}
<div class="hero-container">
  <div class="hero-morph" id="heroMorph"></div>
    
  <div class="hero-content" id="heroContent">
    <h1 class="hero-logo">Seer</h1>
    <span class="hero-phonetic">siːə(ɹ)</span>
    <p class="hero-tagline">Web Design. Hosting. Custom Software.</p>
  </div>
</div>

<div class="sidebar-logo" id="sidebarLogo">Seer Design</div>

<div class="hero-bottom" id="heroBottom">
  <div class="hero-cta">
    <h2>Let's build something<br>uniquely yours.</h2>
    <a href="#contact" class="cta-button">
      Start a conversation
    </a>
  </div>
</div>

<div class="main-wrapper">
  <div class="main-content">
    
    <section class="content-section" data-animate>
      <span class="section-label">About</span>
      <h2 class="section-title">You deserve a website that's actually yours.</h2>
      <div class="section-body">
        <p>
          I create custom websites that you own outright - designed around your needs, 
          not a template's constraints. As a solo developer with 7+ years of engineering 
          experience building complex software systems, I bring <span class="highlight">technical depth 
            without agency overhead</span>.
        </p>
        <p>
          What this means for you: direct communication with the person building your site, 
          solutions tailored to your actual workflow and goals, and clean, maintainable code 
          you can take anywhere.
        </p>
        <p>
          I'm currently building my portfolio of web design clients, which means you get 
          experienced engineering at accessible rates while I establish this side of my practice.
        </p>
      </div>
    </section>
    
    <section class="content-section" data-animate>
      <span class="section-label">Services</span>
      <h2 class="section-title">How I can help</h2>
      
      <div class="services-grid">
        <div class="service-card">
          <h4>Web Design & Hosting</h4>
          <p>
            Your website should work as hard as you do. I build custom sites from the 
            ground up—whether that's a portfolio to showcase your work, an event site, 
            or a business presence that reflects who you actually are. Modern, responsive 
            design that looks great on any device. I handle the technical details so you don't have to.
          </p>
        </div>
        
        <div class="service-card">
          <h4>Custom Software Development</h4>
          <p>
            Have a specific business problem that off-the-shelf software doesn't quite solve? 
            I specialize in building custom tools and integrations—from automation workflows 
            to data management systems. Built to fit your process, not the other way around.
          </p>
        </div>
        
        <div class="service-card">
          <h4>Strategy & Consulting</h4>
          <p>
            A website is a tool in your belt. Let's make sure it's the right tool, 
            sharpened for your specific goals. I help you think through what you actually 
            need before writing a single line of code.
          </p>
        </div>
      </div>
    </section>
    
    <section class="content-section" data-animate>
      <span class="section-label">Process</span>
      <h2 class="section-title">Built with intention,<br>delivered with care.</h2>
      <div class="section-body">
        <p>
          Every project starts with understanding: your goals, your audience, your constraints. 
          From there, I design and build iteratively, keeping you involved at every step. 
          No black boxes, no surprises.
        </p>
        <p>
          The result: a website that genuinely serves your needs, built on a foundation 
          you can maintain and grow.
        </p>
      </div>
    </section>
    
    <section class="content-section" data-animate id="contact">
      <span class="section-label">Contact</span>
      <h2 class="section-title">Ready to start?</h2>
      <div class="section-body">
        <p>
          I'd love to hear about your project. Whether you have a clear vision or 
          just a rough idea, let's talk about how we can bring it to life.
        </p>
        <p style="margin-top: 2rem;">
          <a href="#" class="cta-button">
            Get in touch
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M5 12h14M12 5l7 7-7 7"/>
            </svg>
          </a>
        </p>
      </div>
    </section>
    
    <div style="height: 20vh;"></div>
    
  </div>
</div>

<div style="hidden" class="scroll-progress" id="scrollProgress">
</div>

<script>
  (function() {
    'use strict';
    
    const CONFIG = {
      scrollStart: 0,
      scrollPhase1End: window.innerHeight * 0.5,
      scrollPhase2End: window.innerHeight * 0.8,
      sidebarWidth: 80,
      heroMinHeight: 80,
    };
    
    const heroMorph = document.getElementById('heroMorph');
    const heroContent = document.getElementById('heroContent');
    const heroBottom = document.getElementById('heroBottom');
    const sidebarLogo = document.getElementById('sidebarLogo');
    const scrollProgress = document.getElementById('scrollProgress');
    const contentSections = document.querySelectorAll('[data-animate]');
    
    let ticking = false;

    const MOBILE_MQ = window.matchMedia('(max-width: 768px)');

    function applyHeroMorphOpacity(phase2Progress) {
      if (!MOBILE_MQ.matches) {
        heroMorph.style.opacity = '1';
        return;
      }
  
      if (phase2Progress < 0.4) {
        heroMorph.style.opacity = '1';
      } else if (phase2Progress >= 0.5) {
        heroMorph.style.opacity = '0';
      } else {
        const fadeProgress = (phase2Progress - 0.4) / 0.1;
        heroMorph.style.opacity = (1 - fadeProgress).toString();
      }
    }
    
    function calculateClipPath(scrollY) {
      const phase1Progress = Math.min(1, scrollY / CONFIG.scrollPhase1End);
      const phase2Start = CONFIG.scrollPhase1End;
      const phase2Progress = Math.max(0, Math.min(1, (scrollY - phase2Start) / (CONFIG.scrollPhase2End - phase2Start)));
      
      const easeOutCubic = (t) => 1 - Math.pow(1 - t, 3);
      const easeInOutCubic = (t) => t < 0.5 ? 4 * t * t * t : 1 - Math.pow(-2 * t + 2, 3) / 2;
      
      const easedPhase1 = easeOutCubic(phase1Progress);
      const easedPhase2 = easeInOutCubic(phase2Progress);
      
      const initialBottom = 50;
      const maxBottom = 100 - (CONFIG.heroMinHeight / window.innerHeight * 100);
      
      if (phase2Progress === 0) {
        const currentBottom = initialBottom + (maxBottom - initialBottom) * easedPhase1;
        return `inset(0 0 ${currentBottom}% 0)`;
      }
      
      const sidebarWidthPercent = (CONFIG.sidebarWidth / window.innerWidth) * 100;
      const armLength = easedPhase2 * 100;
      const topGap = easedPhase2 * (100 - 2 * sidebarWidthPercent); 
      
      const gapStart = 50 - (topGap / 2);
      const gapEnd = 50 + (topGap / 2); 
      
      const topBarHeight = CONFIG.heroMinHeight / window.innerHeight * 100;
      
      return `polygon(
          /* Outer edge - clockwise */
          0% 0%,
          100% 0%,
          100% ${topBarHeight + armLength}%,
          ${100 - sidebarWidthPercent}% ${topBarHeight + armLength}%,
          ${100 - sidebarWidthPercent}% ${topBarHeight}%,
          ${sidebarWidthPercent}% ${topBarHeight}%,
          ${sidebarWidthPercent}% ${topBarHeight + armLength}%,
          0% ${topBarHeight + armLength}%
        )`;
    }
    
    function updateOnScroll() {
      const scrollY = window.scrollY;
      const viewportHeight = window.innerHeight;
      
      const totalScrollRange = CONFIG.scrollPhase2End;
      const progressPercent = Math.min(100, (scrollY / totalScrollRange) * 100).toFixed(0);
      //scrollProgress.textContent = `Scroll: ${scrollY.toFixed(0)}px | Progress: ${progressPercent}%`;
      
      const clipPath = calculateClipPath(scrollY);
      heroMorph.style.clipPath = clipPath;
      
      const contentFadeEnd = CONFIG.scrollPhase1End * 0.3;
      const contentOpacity = Math.max(0, 1 - (scrollY / contentFadeEnd));
      heroContent.style.opacity = contentOpacity;
      
      if (contentOpacity <= 0) {
        heroContent.classList.add('hidden');
      } else {
        heroContent.classList.remove('hidden');
      }
      
      const bottomFadeStart = CONFIG.scrollPhase1End * 0.2;
      const bottomFadeEnd = CONFIG.scrollPhase1End * 0.6;
      const bottomProgress = Math.max(0, Math.min(1, (scrollY - bottomFadeStart) / (bottomFadeEnd - bottomFadeStart)));
      
      if (bottomProgress >= 1) {
        heroBottom.classList.add('hidden');
      } else {
        heroBottom.classList.remove('hidden');
        heroBottom.style.opacity = 1 - bottomProgress;
      }
      
      const phase2Progress = Math.max(0, (scrollY - CONFIG.scrollPhase1End) / (CONFIG.scrollPhase2End - CONFIG.scrollPhase1End));
      if (phase2Progress > 0.5) {
        sidebarLogo.classList.add('visible');
      } else {
        sidebarLogo.classList.remove('visible');
      }
      
      if (phase2Progress >= 0.4) {
        document.body.classList.add('sidebars-active');
      } else {
        document.body.classList.remove('sidebars-active');
      }

      applyHeroMorphOpacity(phase2Progress);
      
      contentSections.forEach((section) => {
        const rect = section.getBoundingClientRect();
        const triggerPoint = viewportHeight * 0.85;
        
        if (rect.top < triggerPoint) {
          section.classList.add('visible');
        }
      });
      
      ticking = false;
    }
    
    function onScroll() {
      if (!ticking) {
        requestAnimationFrame(updateOnScroll);
        ticking = true;
      }
    }
    
    function init() {
      updateOnScroll();
      
      window.addEventListener('scroll', onScroll, { passive: true });

      if (typeof MOBILE_MQ.addEventListener === 'function') {
        MOBILE_MQ.addEventListener('change', () => {
          const scrollY = window.scrollY;
          const phase2Progress = Math.max(0, (scrollY - CONFIG.scrollPhase1End) / (CONFIG.scrollPhase2End - CONFIG.scrollPhase1End));
          applyHeroMorphOpacity(phase2Progress);
          updateOnScroll();
        });
      }
      
      window.addEventListener('resize', () => {
        CONFIG.scrollPhase1End = window.innerHeight * 0.5;
        CONFIG.scrollPhase2End = window.innerHeight * 0.8;
        updateOnScroll();
      });      
    }
    
    if (document.readyState === 'loading') {
      document.addEventListener('DOMContentLoaded', init);
    } else {
      init();
    }
  })();
</script>
{% endblock %}
