{% extends 'katzen/base.html.twig' %}

{% block title %}All Items{% endblock %}

{% block main_content %}
<div class="container my-4">

  {# — Category selector nav — #}
  <ul class="nav nav-pills mb-4">
    <li class="nav-item">
      <a 
        class="nav-link {% if not selectedCategory %}active{% endif %}" 
        href="{{ path('item_index') }}">
        All</a>
    </li>
    {% for cat in categories %}
      <li class="nav-item">
        <a
          class="nav-link {% if selectedCategory == cat %}active{% endif %}"
          href="{{ path('item_index', { category: cat }) }}">
          {{ cat }}
        </a>
      </li>
    {% endfor %}
  </ul>

  {# — Items table — #}
  <div class="table-responsive">
    <table class="table table-striped align-middle">
      <thead class="table-light">
        <tr>
          <th>Name</th>
          <th>Category</th>
          <th>Subcategory</th>
          <th class="text-end">Actions</th>
        </tr>
      </thead>
      <tbody>
        {% for item in items %}
          <tr>
            <td>
              <a href="{{ path('item_show', { id: item.id }) }}" class="text-decoration-none">{{ item.name }}</a>
            </td>
            <td>{{ item.category }}</td>
            <td>{{ item.subcategory ?: '—' }}</td>
            <td class="text-end">
              <div class="btn-group btn-group-sm">
                <a href="{{  path('admin') }}" class="btn btn-outline-secondary" title="Edit">
                  <i class="bi bi-pencil-fill"></i>
                </a>
                <form method="post"
                      action="{{ path('item_delete', { id: item.id }) }}"
                      style="display:inline"
                      onsubmit="return confirm('Delete this item?');">
                  <input type="hidden" name="_token" value="{{ csrf_token('delete_item_' ~ item.id) }}">
                  <button class="btn btn-outline-danger" title="Delete">
                    <i class="bi bi-trash-fill"></i>
                  </button>
                </form>
              </div>
            </td>
          </tr>
        {% else %}
          <tr>
            <td colspan="4" class="text-center py-4">
              No items found.
            </td>
          </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>

</div>
{% endblock %}
